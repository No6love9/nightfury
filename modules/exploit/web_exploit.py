from core.base_module import BaseModule
import requests

class WebExploit(BaseModule):
    def __init__(self, framework):
        super().__init__(framework)
        self.name = "web_exploit"
        self.description = "Test for common web vulnerabilities."

    def run(self, args):
        if not args:
            print("Usage: use web_exploit <url>")
            return
        
        url = args[0]
        self.log(f"Testing {url} for common vulnerabilities...")
        
        # SQLi test
        payload = "' OR '1'='1"
        try:
            resp = requests.get(f"{url}?id={payload}", timeout=5)
            if "sql" in resp.text.lower() or "error" in resp.text.lower():
                print("[+] Potential SQL Injection vulnerability detected!")
            else:
                print("[-] No obvious SQLi detected.")
        except Exception as e:
            print(f"[!] Error testing SQLi: {e}")
        
        # XSS test
        payload = "<script>alert(1)</script>"
        try:
            resp = requests.get(f"{url}?q={payload}", timeout=5)
            if payload in resp.text:
                print("[+] Potential XSS vulnerability detected!")
            else:
                print("[-] No obvious XSS detected.")
        except Exception as e:
            print(f"[!] Error testing XSS: {e}")
